# EasyJob Next.js - Contexte Technique pour Claude Code

**Design System "Connexions"** ‚Ä¢ Next.js 14 ‚Ä¢ TypeScript ‚Ä¢ Prisma ‚Ä¢ Supabase

Plateforme de job service compl√®te pour TBS Education avec backend fonctionnel et design minimaliste √©pur√©.

---

## üéØ Objectif du Projet

EasyJob est le **job service officiel de TBS Education** qui met en relation :
- **√âtudiants TBS** : Recherche de stages, CDD, CDI et petits boulots
- **Entreprises** : Acc√®s √† un vivier de talents qualifi√©s

**Philosophie Design** : Minimalisme radical. 90% monochrome (noir/blanc/gris), 10% rose TBS (#EA5256) utilis√© avec parcimonie pour un impact maximal.

---

## üìÇ Architecture du Projet

### Structure

```
easyjob-next/
‚îú‚îÄ‚îÄ app/                       # Next.js App Router
‚îÇ   ‚îú‚îÄ‚îÄ api/                   # API Routes (backend)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ jobs/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ route.ts       # GET /api/jobs, POST /api/jobs
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ [id]/
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ route.ts   # GET/PATCH/DELETE /api/jobs/[id]
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ apply/
‚îÇ   ‚îÇ               ‚îî‚îÄ‚îÄ route.ts # POST /api/jobs/[id]/apply
‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx             # Root layout avec fonts
‚îÇ   ‚îú‚îÄ‚îÄ page.tsx               # Homepage (Server Component)
‚îÇ   ‚îî‚îÄ‚îÄ globals.css            # Tailwind + design system tokens
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ Nav.tsx                # Navigation sticky avec scroll detection
‚îÇ   ‚îú‚îÄ‚îÄ Footer.tsx             # Footer minimaliste
‚îÇ   ‚îî‚îÄ‚îÄ JobCard.tsx            # Card d'offre avec badge dynamique
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îú‚îÄ‚îÄ prisma.ts              # Client Prisma singleton
‚îÇ   ‚îî‚îÄ‚îÄ supabase.ts            # Client Supabase + auth helpers
‚îú‚îÄ‚îÄ prisma/
‚îÇ   ‚îî‚îÄ‚îÄ schema.prisma          # Sch√©ma DB complet (5 models)
‚îú‚îÄ‚îÄ .env.example               # Template variables d'environnement
‚îú‚îÄ‚îÄ package.json               # Dependencies
‚îú‚îÄ‚îÄ tailwind.config.ts         # Config Tailwind + design tokens
‚îú‚îÄ‚îÄ tsconfig.json              # Config TypeScript
‚îî‚îÄ‚îÄ README.md                  # Documentation compl√®te
```

---

## üóÑÔ∏è Base de Donn√©es (Prisma + Supabase PostgreSQL)

### Sch√©ma Principal

**5 mod√®les** interconnect√©s avec relations :

#### 1. User
```prisma
model User {
  id            String   @id @default(uuid())
  email         String   @unique
  passwordHash  String   @map("password_hash")
  role          UserRole @default(STUDENT)
  firstName     String   @map("first_name")
  lastName      String   @map("last_name")
  phone         String?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  studentProfile StudentProfile?
  applications   Application[]
  Company        Company[]
}

enum UserRole {
  STUDENT
  RECRUITER
  ADMIN
}
```

**Relations** :
- 1 User ‚Üí 1 StudentProfile (optional)
- 1 User ‚Üí N Applications (si √©tudiant)
- 1 User ‚Üí N Companies (si recruteur)

#### 2. StudentProfile
```prisma
model StudentProfile {
  userId         String   @id @map("user_id")
  program        String
  graduationYear Int      @map("graduation_year")
  cvUrl          String?  @map("cv_url")
  linkedinUrl    String?  @map("linkedin_url")
  skills         String[] @default([])
  bio            String?  @db.Text

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
}
```

**Cas d'usage** :
- Stocker les infos acad√©miques des √©tudiants
- CV upload dans Supabase Storage
- Skills array pour matching futur (phase 3)

#### 3. Company
```prisma
model Company {
  id          String   @id @default(uuid())
  name        String
  logoUrl     String?  @map("logo_url")
  description String?  @db.Text
  website     String?
  createdById String   @map("created_by_id")
  createdAt   DateTime @default(now())

  createdBy User  @relation(fields: [createdById], references: [id])
  jobs      Job[]
}
```

**Relations** :
- 1 Company ‚Üí N Jobs
- 1 Company appartient √† 1 User (recruteur)

#### 4. Job (Mod√®le central)
```prisma
model Job {
  id                String    @id @default(uuid())
  companyId         String    @map("company_id")
  title             String
  type              JobType
  location          String
  description       String    @db.Text
  requirements      String?   @db.Text
  salaryRange       String?   @map("salary_range")
  status            JobStatus @default(DRAFT)
  publishedAt       DateTime? @map("published_at")
  expiresAt         DateTime? @map("expires_at")
  viewsCount        Int       @default(0) @map("views_count")
  applicationsCount Int       @default(0) @map("applications_count")
  createdAt         DateTime  @default(now())
  updatedAt         DateTime  @updatedAt

  company      Company       @relation(fields: [companyId], references: [id], onDelete: Cascade)
  applications Application[]

  @@index([status])
  @@index([type])
  @@index([companyId])
}

enum JobType {
  STAGE          # Internship
  CDD            # Fixed-term contract
  CDI            # Permanent contract
  PETIT_BOULOT   # Part-time/student job
}

enum JobStatus {
  DRAFT
  PUBLISHED
  CLOSED
}
```

**Index critiques** :
- `status` : Pour filtrer les offres publi√©es (requ√™te fr√©quente)
- `type` : Pour filtrage par type d'offre
- `companyId` : Pour queries de l'entreprise

**Compteurs d√©normalis√©s** :
- `viewsCount` : Incr√©ment√© √† chaque GET /api/jobs/[id]
- `applicationsCount` : Incr√©ment√© √† chaque candidature

#### 5. Application
```prisma
model Application {
  id            String            @id @default(uuid())
  jobId         String            @map("job_id")
  userId        String            @map("user_id")
  coverLetter   String            @map("cover_letter") @db.Text
  cvUrl         String?           @map("cv_url")
  status        ApplicationStatus @default(PENDING)
  createdAt     DateTime          @default(now())

  job  Job  @relation(fields: [jobId], references: [id], onDelete: Cascade)
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([jobId, userId]) // Un user ne peut postuler qu'une fois par offre
  @@index([userId])
  @@index([jobId])
}

enum ApplicationStatus {
  PENDING
  REVIEWED
  ACCEPTED
  REJECTED
}
```

**Contraintes** :
- `@@unique([jobId, userId])` : Emp√™che les candidatures multiples

---

## üîå API Routes (Backend)

### 1. GET /api/jobs
**Description** : Liste des offres avec filtres et pagination

**Query Params** :
- `type` : `STAGE | CDD | CDI | PETIT_BOULOT`
- `location` : Recherche insensible √† la casse (ex: `Toulouse`)
- `search` : Recherche dans `title` et `description`
- `limit` : Nombre d'offres (d√©faut: 20)
- `offset` : Pagination (d√©faut: 0)

**Exemple** :
```bash
GET /api/jobs?type=STAGE&location=Toulouse&limit=10
```

**Response** :
```json
{
  "jobs": [
    {
      "id": "uuid",
      "title": "Stage Data Analyst",
      "type": "STAGE",
      "location": "Toulouse",
      "description": "...",
      "company": {
        "name": "Airbus",
        "logoUrl": "https://..."
      },
      "publishedAt": "2026-01-01T10:00:00Z",
      "viewsCount": 42,
      "applicationsCount": 5
    }
  ],
  "total": 347,
  "limit": 10,
  "offset": 0
}
```

**Impl√©mentation** : `easyjob-next/app/api/jobs/route.ts:6-68`

---

### 2. POST /api/jobs
**Description** : Cr√©er une offre (recruteur uniquement)

**‚ö†Ô∏è TODO** : Authentification (ligne 84-87)

**Body** (Zod validation) :
```json
{
  "companyId": "uuid",
  "title": "Stage Data Analyst",
  "type": "STAGE",
  "location": "Toulouse",
  "description": "Description longue minimum 50 caract√®res...",
  "requirements": "Master 1/2, Python, SQL...",
  "salaryRange": "1200‚Ç¨/mois"
}
```

**Response** : `201 Created` avec l'offre cr√©√©e (status: DRAFT par d√©faut)

**Validation** :
- `title` : min 5, max 255 caract√®res
- `description` : min 50 caract√®res
- `type` : enum strict
- `companyId` : format UUID

**Impl√©mentation** : `easyjob-next/app/api/jobs/route.ts:70-122`

---

### 3. GET /api/jobs/[id]
**Description** : D√©tail d'une offre + incr√©ment compteur de vues

**Comportement** :
- Incr√©mente automatiquement `viewsCount` √† chaque requ√™te
- Retourne la company avec nom + logo

**Response** :
```json
{
  "id": "uuid",
  "title": "Stage Data Analyst",
  "type": "STAGE",
  "location": "Toulouse",
  "description": "...",
  "requirements": "...",
  "salaryRange": "1200‚Ç¨/mois",
  "status": "PUBLISHED",
  "publishedAt": "2026-01-01T10:00:00Z",
  "viewsCount": 43,
  "applicationsCount": 5,
  "company": {
    "name": "Airbus",
    "logoUrl": "https://...",
    "website": "https://airbus.com"
  }
}
```

**Impl√©mentation** : `easyjob-next/app/api/jobs/[id]/route.ts:6-42`

---

### 4. PATCH /api/jobs/[id]
**Description** : Modifier une offre (recruteur propri√©taire uniquement)

**‚ö†Ô∏è TODO** : V√©rification ownership (ligne 47)

**Body** (partiel autoris√©) :
```json
{
  "title": "Nouveau titre",
  "status": "PUBLISHED"
}
```

**Response** : `200 OK` avec l'offre modifi√©e

**Impl√©mentation** : `easyjob-next/app/api/jobs/[id]/route.ts:44-83`

---

### 5. DELETE /api/jobs/[id]
**Description** : Supprimer une offre (recruteur propri√©taire uniquement)

**‚ö†Ô∏è TODO** : V√©rification ownership (ligne 88)

**Cascade** : Les applications li√©es sont supprim√©es automatiquement (`onDelete: Cascade` dans Prisma)

**Response** : `200 OK` avec message de succ√®s

**Impl√©mentation** : `easyjob-next/app/api/jobs/[id]/route.ts:85-110`

---

### 6. POST /api/jobs/[id]/apply
**Description** : Postuler √† une offre (√©tudiant uniquement)

**‚ö†Ô∏è TODO** : Authentification (ligne 14-19)

**Body** :
```json
{
  "coverLetter": "Lettre de motivation...",
  "cvUrl": "https://storage.supabase.co/..."
}
```

**Comportements** :
1. Cr√©e l'application (status: PENDING)
2. Incr√©mente `job.applicationsCount`
3. **TODO** : Envoyer email au recruteur (ligne 41)

**Contrainte** : `@@unique([jobId, userId])` emp√™che les candidatures multiples (retourne 400 si doublon)

**Response** : `201 Created` avec l'application

**Impl√©mentation** : `easyjob-next/app/api/jobs/[id]/apply/route.ts:12-66`

---

## üé® Design System "Connexions"

### Philosophie

**Minimalisme radical** :
- 90% de l'interface en noir/blanc/gris
- 10% rose TBS (#EA5256) pour les accents strat√©giques
- Bordures ultra-fines (0.5px partout)
- Espaces n√©gatifs extr√™mes (padding 96px, marges 10%)
- Typographie contrast√©e (weights 300 vs 600)
- Grille stricte baseline 8px

**Inspiration** : Design suisse, Bauhaus moderne, esth√©tique √©pur√©e premium

---

### Palette de Couleurs

```css
/* Monochromes (90% de l'interface) */
--noir: #0A0A0A
--gris-fonce: #3A3A3A
--gris-moyen: #7A7A7A
--gris-clair: #D4D4D4
--blanc-casse: #FAFAFA
--blanc: #FFFFFF

/* Accents (10% de l'interface) */
--rose-tbs: #EA5256      /* CTAs, compteurs, badges stage */
--violet-rare: #8b5cf6   /* Badges stage uniquement */
--rose-hover: #d43f43    /* Hover boutons */
```

**R√®gle d'or** : Le rose TBS doit toujours attirer l'≈ìil vers les actions cl√©s (CTAs, compteurs). Ne jamais l'utiliser pour du contenu passif.

---

### Typographie

**Fonts** :
- **Inter** (300, 400, 500, 600) : Police principale
- **JetBrains Mono** (400) : Compteurs et m√©triques

**Hi√©rarchie** :
```css
.text-6xl   64px / 300 light   /* Hero title */
.text-5xl   48px / 300 light   /* Section title */
.text-3xl   30px / 300 light   /* Card title */
.text-lg    18px / 400 regular /* Corps de texte */
.text-sm    14px / 600 semibold uppercase tracking-wider /* CTAs */
```

**Tracking** :
- Titres : `-0.02em` (serr√©)
- CTAs : `+0.05em` (large)

---

### Composants Tailwind

Tous d√©finis dans `easyjob-next/app/globals.css`

#### Boutons

```css
/* Bouton primaire (rose TBS) */
.btn-primary {
  px-12 py-4 bg-rose-tbs text-white
  text-sm font-semibold uppercase tracking-wider
  rounded-xl shadow-md
  hover:bg-rose-hover hover:-translate-y-0.5
  transition-all duration-200
}

/* Bouton secondaire (outline noir) */
.btn-secondary {
  px-12 py-4 bg-white text-noir
  border border-noir rounded-xl
  hover:-translate-y-0.5
}
```

#### Job Card

```css
.job-card {
  bg-white border border-gris-clair rounded-xl
  p-8 transition-all duration-200
  hover:border-noir hover:-translate-y-1 hover:shadow-lg
}
```

#### Badges

```css
.badge {
  px-3 py-1.5 text-xs uppercase tracking-wider rounded-full
}

.badge-stage {
  bg-violet-rare/10 text-violet-rare
}

.badge-cdi {
  bg-rose-tbs/10 text-rose-tbs
}

.badge-cdd {
  bg-noir/10 text-noir
}

.badge-petit-boulot {
  bg-gris-moyen/10 text-gris-moyen
}
```

#### Connection Point

```css
.connection-point {
  width: 4px;
  height: 4px;
  border-radius: 50%;
  background: var(--rose-tbs);
  outline: 12px solid transparent;
  border: 1px solid var(--rose-tbs);
}
```

**Utilisation** : Marqueur visuel pour symboliser les connexions (concept du design system)

---

### Espacements (Grille 8px)

```css
--space-1: 8px
--space-2: 16px
--space-4: 32px
--space-6: 48px
--space-8: 64px
--space-10: 80px
--space-12: 96px
```

**R√®gle** : Tous les espacements doivent √™tre des multiples de 8px.

---

### Layout Sections

```css
.section {
  padding: 96px 0;  /* Vertical padding extr√™me */
}

.section-container {
  max-width: 1400px;
  margin: 0 auto;
  padding: 0 10%;  /* Marges lat√©rales 10% */
}

.section-title {
  font-size: 48px;
  font-weight: 300;
  text-align: center;
  margin-bottom: 64px;
}
```

---

## üß© Composants React

### Nav.tsx
**Type** : Client Component (`'use client'`)

**Fonctionnalit√©s** :
- Sticky navigation avec backdrop blur
- D√©tection scroll (classe `scrolled` ajout√©e apr√®s 50px)
- Menu mobile hamburger (toggle state)
- Links : Offres, Recruteurs, √Ä propos, Mon espace

**Hooks** :
- `useState` : `scrolled`, `mobileMenuOpen`
- `useEffect` : Listener scroll avec cleanup

**Impl√©mentation** : `easyjob-next/components/Nav.tsx:6-122`

---

### JobCard.tsx
**Type** : Client Component

**Props** :
```typescript
interface JobCardProps {
  job: {
    id: string
    title: string
    type: 'STAGE' | 'CDD' | 'CDI' | 'PETIT_BOULOT'
    location: string
    description: string
    publishedAt: Date | null
    company: {
      name: string
      logoUrl: string | null
    }
  }
}
```

**Fonctionnalit√©s** :
- Badge dynamique avec couleur selon le type
- Calcul "time ago" (Il y a 2h, Il y a 3j)
- Truncate description (150 caract√®res)
- Link vers `/jobs/[id]`

**Helper** :
```typescript
function timeAgo(date: Date) {
  const diff = Date.now() - date.getTime()
  const hours = Math.floor(diff / (1000 * 60 * 60))
  if (hours < 24) return `Il y a ${hours}h`
  const days = Math.floor(hours / 24)
  return `Il y a ${days}j`
}
```

**Impl√©mentation** : `easyjob-next/components/JobCard.tsx:3-76`

---

### Footer.tsx
**Type** : Server Component

**Design** : Minimaliste
- 3 colonnes : √Ä propos, Liens rapides, Contact
- Copyright ¬© 2026 EasyJob ‚Äî TBS Education
- Border top gris clair

**Impl√©mentation** : `easyjob-next/components/Footer.tsx:1-68`

---

## üè† Homepage (app/page.tsx)

**Type** : Server Component (`async function`)

**Fonctionnalit√©s** :
1. Fetch des 6 derni√®res offres publi√©es depuis Prisma
2. Affichage Hero avec titre, compteurs, CTA
3. Section offres (grid 3 colonnes)
4. Section processus (3 √©tapes)
5. Section recruteurs (CTA card)

**Fetch optimis√©** :
```typescript
async function getJobs() {
  const jobs = await prisma.job.findMany({
    where: { status: 'PUBLISHED' },
    include: {
      company: {
        select: { name: true, logoUrl: true }
      }
    },
    orderBy: { publishedAt: 'desc' },
    take: 6
  })
  return jobs
}
```

**Gestion erreur** : Return `[]` si √©chec (fallback gracieux)

**Dynamic rendering** : `export const dynamic = 'force-dynamic'` pour √©viter le cache

**Impl√©mentation** : `easyjob-next/app/page.tsx:9-208`

---

## üîê Authentification (TODO)

### √âtat Actuel

**Placeholders pr√©sents** dans :
- `POST /api/jobs` (ligne 84)
- `PATCH /api/jobs/[id]` (ligne 47)
- `DELETE /api/jobs/[id]` (ligne 88)
- `POST /api/jobs/[id]/apply` (ligne 14)

**Exemple de TODO** :
```typescript
// TODO: V√©rifier authentification et r√¥le recruteur
// const session = await getSession(request)
// if (!session || session.user.role !== 'RECRUITER') {
//   return NextResponse.json({ error: 'Unauthorized' }, { status: 403 })
// }
```

### Impl√©mentation Recommand√©e (Supabase Auth)

**1. Configuration Supabase Auth**

Dans `lib/supabase.ts` :
```typescript
import { createClient } from '@supabase/supabase-js'

const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!
const supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!

export const supabase = createClient(supabaseUrl, supabaseKey)

export async function getCurrentUser() {
  const { data: { user } } = await supabase.auth.getUser()
  return user
}

export async function isAuthenticated() {
  const user = await getCurrentUser()
  return !!user
}
```

**2. Middleware d'authentification**

Cr√©er `middleware.ts` √† la racine :
```typescript
import { NextRequest, NextResponse } from 'next/server'
import { createMiddlewareClient } from '@supabase/auth-helpers-nextjs'

export async function middleware(req: NextRequest) {
  const res = NextResponse.next()
  const supabase = createMiddlewareClient({ req, res })

  const { data: { session } } = await supabase.auth.getSession()

  // Prot√©ger les routes API
  if (req.nextUrl.pathname.startsWith('/api/jobs') && req.method !== 'GET') {
    if (!session) {
      return NextResponse.json(
        { error: 'Unauthorized' },
        { status: 401 }
      )
    }
  }

  return res
}

export const config = {
  matcher: ['/api/:path*', '/dashboard/:path*']
}
```

**3. V√©rification r√¥le dans API routes**

```typescript
import { createServerComponentClient } from '@supabase/auth-helpers-nextjs'
import { cookies } from 'next/headers'
import { prisma } from '@/lib/prisma'

export async function POST(request: NextRequest) {
  const supabase = createServerComponentClient({ cookies })
  const { data: { session } } = await supabase.auth.getSession()

  if (!session) {
    return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })
  }

  // R√©cup√©rer le user depuis Prisma pour v√©rifier le r√¥le
  const user = await prisma.user.findUnique({
    where: { email: session.user.email },
    select: { role: true }
  })

  if (user?.role !== 'RECRUITER' && user?.role !== 'ADMIN') {
    return NextResponse.json({ error: 'Forbidden' }, { status: 403 })
  }

  // Cr√©er l'offre...
}
```

**4. Pages √† cr√©er**

- `app/login/page.tsx` : Formulaire login avec Supabase Auth
- `app/register/page.tsx` : Formulaire inscription
- `app/dashboard/page.tsx` : Dashboard √©tudiant/recruteur

---

## üìß Emails (Resend)

### Configuration

**1. Installation**
```bash
npm install resend
```

**2. Variable d'environnement**
```env
RESEND_API_KEY=re_your_key
```

**3. Cr√©er `lib/email.ts`**

```typescript
import { Resend } from 'resend'

const resend = new Resend(process.env.RESEND_API_KEY)

export async function sendApplicationNotification(
  recruiterEmail: string,
  job: { title: string },
  student: { firstName: string; lastName: string; email: string }
) {
  await resend.emails.send({
    from: 'EasyJob <noreply@easyjob-tbs.fr>',
    to: recruiterEmail,
    subject: `Nouvelle candidature : ${job.title}`,
    html: `
      <h2>Nouvelle candidature</h2>
      <p><strong>${student.firstName} ${student.lastName}</strong> (${student.email}) a postul√© pour <strong>${job.title}</strong>.</p>
      <p><a href="${process.env.NEXT_PUBLIC_APP_URL}/dashboard/applications">Voir la candidature</a></p>
    `
  })
}
```

**4. Appeler dans `POST /api/jobs/[id]/apply`**

```typescript
// Apr√®s avoir cr√©√© l'application
const recruiter = await prisma.user.findFirst({
  where: { Company: { some: { id: job.companyId } } },
  select: { email: true }
})

if (recruiter) {
  await sendApplicationNotification(
    recruiter.email,
    { title: job.title },
    { firstName: user.firstName, lastName: user.lastName, email: user.email }
  )
}
```

---

## üöÄ Setup Local

### 1. Pr√©requis

```bash
Node.js 18+
npm ou pnpm
Compte Supabase (gratuit)
```

### 2. Installation

```bash
cd easyjob-next
npm install
```

### 3. Configuration Supabase

1. Cr√©er un projet sur [supabase.com](https://supabase.com)
2. R√©cup√©rer :
   - URL du projet (Dashboard ‚Üí Settings ‚Üí API)
   - Anon key (cl√© publique)
   - Service key (cl√© priv√©e)
   - Connection string PostgreSQL (Dashboard ‚Üí Settings ‚Üí Database)

3. Cr√©er `.env.local` :

```bash
cp .env.example .env.local
```

4. Remplir `.env.local` :

```env
# Supabase
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key
SUPABASE_SERVICE_KEY=your-service-key

# Database
DATABASE_URL=postgresql://postgres:[PASSWORD]@db.your-project.supabase.co:5432/postgres

# Resend (optionnel pour MVP)
RESEND_API_KEY=re_your_key

# App
NEXT_PUBLIC_APP_URL=http://localhost:3000
```

### 4. Setup Base de Donn√©es

```bash
# G√©n√©rer le client Prisma
npx prisma generate

# Cr√©er les tables (push schema)
npx prisma db push

# (Optionnel) Seed avec donn√©es de test
npx prisma db seed
```

### 5. Lancer le serveur dev

```bash
npm run dev
```

Ouvrir [http://localhost:3000](http://localhost:3000) üéâ

---

## üêõ Debugging

### Probl√®me : "Can't reach database"

```bash
# V√©rifier DATABASE_URL dans .env.local
# S'assurer que le projet Supabase est actif
npx prisma db push --force-reset
```

### Probl√®me : "Module not found: Can't resolve '@/...'"

```bash
# Relancer le serveur dev
rm -rf .next
npm run dev
```

### Probl√®me : Prisma Client non g√©n√©r√©

```bash
npx prisma generate
```

---

## üö¢ D√©ploiement Vercel

### 1. Push vers GitHub

```bash
git init
git add .
git commit -m "Initial commit"
git remote add origin https://github.com/username/easyjob-next.git
git push -u origin main
```

### 2. Import sur Vercel

1. Aller sur [vercel.com](https://vercel.com)
2. "Import Project" ‚Üí S√©lectionner le repo GitHub
3. Framework Preset : Next.js (d√©tect√© automatiquement)
4. Configurer les **Environment Variables** (m√™me que `.env.local`) :
   - `NEXT_PUBLIC_SUPABASE_URL`
   - `NEXT_PUBLIC_SUPABASE_ANON_KEY`
   - `SUPABASE_SERVICE_KEY`
   - `DATABASE_URL`
   - `RESEND_API_KEY`
   - `NEXT_PUBLIC_APP_URL` (ex: `https://easyjob.vercel.app`)

5. Deploy üöÄ

### 3. Domaine Personnalis√©

Vercel ‚Üí Settings ‚Üí Domains ‚Üí Add `easyjob.tbs-education.fr`

### 4. Prisma sur Vercel

‚ö†Ô∏è **Important** : Prisma Client doit √™tre g√©n√©r√© √† chaque build.

**V√©rifier `package.json`** :
```json
{
  "scripts": {
    "postinstall": "prisma generate",
    "build": "next build"
  }
}
```

Vercel ex√©cutera automatiquement `postinstall` avant le build.

---

## üìä Roadmap

### Phase 1 (MVP) ‚úÖ
- [x] Setup Next.js + Prisma + Supabase
- [x] Design system Connexions int√©gr√©
- [x] API routes basiques (jobs)
- [x] Homepage avec vraies donn√©es DB
- [ ] **Authentification Supabase** (en cours)
- [ ] Pages login/register
- [ ] Dashboard recruteur
- [ ] Upload CV (Supabase Storage)

### Phase 2
- [ ] Syst√®me emails (Resend)
- [ ] Filtres avanc√©s (location, type, search)
- [ ] Recherche full-text (PostgreSQL tsvector)
- [ ] Analytics (Vercel Analytics)
- [ ] Tests (Vitest + Playwright)

### Phase 3
- [ ] Matching IA (OpenAI API) : Sugg√©rer offres selon profil √©tudiant
- [ ] Notifications push (Web Push API)
- [ ] Chat recruteur-√©tudiant (Supabase Realtime)
- [ ] Mobile app (React Native)

---

## ‚ö†Ô∏è TODOs Critiques

### S√©curit√© (Avant Production)

- [ ] **Impl√©menter authentification compl√®te** (Supabase Auth)
- [ ] **Prot√©ger les routes API** (middleware auth)
- [ ] **V√©rifier ownership** sur PATCH/DELETE (user owns resource)
- [ ] **Rate limiting** (√©viter spam candidatures)
- [ ] **Sanitize inputs** (XSS protection)
- [ ] **CSRF tokens** sur formulaires
- [ ] **HTTPS obligatoire** (Vercel le fait auto)
- [ ] **Gestion des r√¥les** (STUDENT vs RECRUITER vs ADMIN)

### Emails

- [ ] Impl√©menter `sendApplicationNotification` dans `/api/jobs/[id]/apply`
- [ ] Email de bienvenue √† l'inscription
- [ ] Email de confirmation apr√®s candidature
- [ ] Digest hebdomadaire des nouvelles offres (√©tudiant)
- [ ] Digest quotidien des candidatures (recruteur)

### UI/UX

- [ ] Page `/jobs` avec filtres et search
- [ ] Page `/jobs/[id]` d√©tail d'offre
- [ ] Page `/dashboard` diff√©renci√©e selon r√¥le
- [ ] Formulaire cr√©ation d'offre (recruteur)
- [ ] Formulaire candidature avec upload CV
- [ ] Page profil √©tudiant (√©dition skills, CV, bio)

---

## üìù Conventions de Code

### TypeScript

- **Strict mode** : Activ√© (`tsconfig.json`)
- **Nommage** :
  - Components : `PascalCase` (ex: `JobCard.tsx`)
  - Functions : `camelCase` (ex: `getJobs()`)
  - Constants : `UPPER_SNAKE_CASE` (ex: `DATABASE_URL`)

### Prisma

- **Nommage DB** : `snake_case` avec `@map()`
- **Relations** : Toujours d√©finir `onDelete` (Cascade ou Restrict)
- **Index** : Ajouter sur les champs filtr√©s fr√©quemment

### API Routes

- **Validation** : Toujours utiliser Zod pour valider les inputs
- **Erreurs** :
  - 400 Bad Request : Validation failed
  - 401 Unauthorized : Pas authentifi√©
  - 403 Forbidden : Pas le bon r√¥le
  - 404 Not Found : Ressource introuvable
  - 500 Internal Server Error : Erreur serveur

### CSS

- **Tailwind** : Privil√©gier les utility classes
- **Custom classes** : D√©finir dans `globals.css` uniquement si r√©utilis√©es 3+ fois
- **Responsive** : Mobile-first (`sm:`, `md:`, `lg:`)

---

## üéØ Points Cl√©s pour Claude Code

1. **Design "Connexions"** : Minimalisme radical = 90% monochrome, 10% rose TBS
2. **Prisma relations** : Toujours inclure les relations n√©cessaires dans les queries
3. **API validation** : Zod schemas d√©finis avant les handlers
4. **TODO auth** : Ne pas impl√©menter d'authentification sans demande explicite
5. **Compteurs** : `viewsCount` et `applicationsCount` sont d√©normalis√©s pour performance
6. **Type-safety** : TypeScript strict, jamais de `any` (sauf `where` Prisma)
7. **Responsive** : Grille 3 colonnes desktop, 2 tablet, 1 mobile
8. **Emails** : TODO dans `/api/jobs/[id]/apply:41`, attendre config Resend

---

## üìö Ressources

- [Next.js 14 Docs](https://nextjs.org/docs)
- [Prisma Docs](https://www.prisma.io/docs)
- [Supabase Docs](https://supabase.com/docs)
- [Tailwind CSS](https://tailwindcss.com)
- [Resend Docs](https://resend.com/docs)
- [Zod Docs](https://zod.dev)

---

**D√©velopp√© avec pr√©cision pour les √©tudiants et entreprises de TBS Education** üéì
